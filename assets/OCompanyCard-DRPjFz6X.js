import{r as n,j as a}from"./index-BTrklhSw.js";import{N as M,A as P}from"./NavBar-DvTkcbrR.js";import{c as Q,o as V,C as X,d as i,g as Y,a as k,r as d,u as A,b as $,e as Z,f as m,h as _,s as u,i as b,j as g}from"./ClipLoader-BTiPzNBm.js";const se=()=>{const[F,W]=n.useState([]),[C,O]=n.useState(""),[h,D]=n.useState(""),[I,v]=n.useState(""),[U,S]=n.useState(""),[p,R]=n.useState(null),[y,E]=n.useState(null),[f,L]=n.useState(null),x=n.useRef(null),j=n.useRef(null),T=Q(i,"OCompanyCards"),[w,l]=n.useState(!0),r=async()=>{l(!0);try{const t=(await Y(T)).docs.map(s=>({...s.data(),id:s.id}));W(t),l(!1)}catch(e){console.error(e),l(!1)}};n.useEffect(()=>{r();const e=V(k,t=>{R(t?t.email:null)});return()=>e()},[]);const q=async()=>{var e,t;if(y&&h&&C){l(!0);const s=`${Date.now()}-${y.name}`,o=d(u,`images/${s}`);await A(o,y);const c=await $(o);try{await Z(T,{title:C,desc:h,imageUrl:c,userId:(t=(e=k)==null?void 0:e.currentUser)==null?void 0:t.uid}),r(),O(""),D(""),E(null),x.current&&(x.current.value=""),l(!1)}catch(N){console.error(N),l(!1)}}else console.error("Something is not selected (image or title or desc)")},B=async(e,t)=>{try{const s=m(i,"OCompanyCards",e);if(await _(s),t){const o=d(u,t);try{await b(o),console.log("Image deleted successfully")}catch(c){console.error("Error deleting image: ",c)}}r(),console.log("OCompanyCard and image deleted")}catch(s){console.error("Error deleting OCompanyCard or image: ",s)}},z=async e=>{try{const t=m(i,"OCompanyCards",e);await g(t,{title:U}),r(),S(""),console.log("OCompanyCard updated")}catch(t){console.error("while updating title",t)}},G=async(e,t)=>{if(f)try{const s=`${Date.now()}-${f.name}`,o=d(u,`images/${s}`);await A(o,f);const c=await $(o),N=m(i,"OCompanyCards",e);if(t){const K=d(u,t);await b(K)}await g(N,{imageUrl:c}),r(),L(null),j.current&&(j.current.value=""),console.log("Image updated")}catch(s){console.error("Error updating image: ",s)}else console.error("No image selected for update")},H=async(e,t)=>{const s=d(u,t);try{await b(s);const o=m(i,"OCompanyCards",e);await g(o,{imageUrl:""}),r(),console.log("Image deleted")}catch(o){console.error("Error deleting image: ",o)}},J=async e=>{try{const t=m(i,"OCompanyCards",e);await g(t,{desc:I}),r(),v(""),console.log("OCompanyCard date updated")}catch(t){console.error("while updating release date",t)}};return a.jsxs("div",{className:"OCompanyCard-admin-wrapper",children:[p&&a.jsx(M,{}),a.jsxs("div",{className:"right-side-wrapper",children:[a.jsx(P,{}),p&&a.jsxs("div",{className:"controlAuthWrapper",children:[a.jsx("h2",{className:"addOCompanyCardTitle",children:"Add New OCompany Card"}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"OCompany Card title...",value:C,onChange:e=>O(e.target.value)}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"OCompany Card desc...",value:h,onChange:e=>D(e.target.value)}),a.jsx("input",{className:"admin-input",type:"file",ref:x,onChange:e=>E(e.target.files?e.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:q,disabled:w,children:"Submit OCompany Card"})]}),p&&(w?a.jsx("div",{className:"loading-indicator",children:a.jsx(X,{size:50,color:"#eee",loading:w})}):a.jsx("div",{className:"controlDataWrapper",children:F.map(e=>a.jsx("div",{className:"OCompanyCardItemWrapperFire",children:p&&a.jsxs(a.Fragment,{children:[a.jsx("h1",{style:{color:"white"},children:e.title}),a.jsx("p",{children:e.desc}),e.imageUrl&&a.jsx("img",{className:"OCompanyCardImgFire",src:e.imageUrl,alt:e.title,width:"500"}),a.jsx("button",{className:"admin-btn",onClick:()=>B(e.id,e.imageUrl),children:"Delete OCompany Card"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",onChange:t=>S(t.target.value),type:"text",value:U,placeholder:"new title..."}),a.jsx("button",{className:"admin-btn",onClick:()=>z(e.id),children:"Update Title"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"file",ref:j,onChange:t=>L(t.target.files?t.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:()=>G(e.id,e.imageUrl),children:"Update Image"}),a.jsx("br",{}),a.jsx("button",{className:"admin-btn",onClick:()=>H(e.id,e.imageUrl),children:"Delete Image"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"text",onChange:t=>v(t.target.value),value:I,placeholder:"new desc..."}),a.jsx("button",{className:"admin-btn",onClick:()=>J(e.id),children:"Update Desc"})]})},e.id))}))]})]})};export{se as default};
