import{r as n,j as a}from"./index-Dc_audPd.js";import{N as K,A as M}from"./NavBar-BRHtXy5k.js";import{c as Q,o as V,C as X,d as l,g as Y,a as T,r as d,u as A,b as $,e as Z,f as g,h as _,s as u,i as b,j as p}from"./ClipLoader-DufgO8qg.js";const se=()=>{const[F,W]=n.useState([]),[h,y]=n.useState(""),[f,P]=n.useState(""),[D,I]=n.useState(""),[v,U]=n.useState(""),[m,S]=n.useState(null),[x,R]=n.useState(null),[C,E]=n.useState(null),j=n.useRef(null),w=n.useRef(null),L=Q(l,"PackingCards"),[k,c]=n.useState(!0),i=async()=>{c(!0);try{const t=(await Y(L)).docs.map(s=>({...s.data(),id:s.id}));W(t),c(!1)}catch(e){console.error(e),c(!1)}};n.useEffect(()=>{i();const e=V(T,t=>{S(t?t.email:null)});return()=>e()},[]);const q=async()=>{var e,t;if(x&&f&&h){c(!0);const s=`${Date.now()}-${x.name}`,r=d(u,`images/${s}`);await A(r,x);const o=await $(r);try{await Z(L,{title:h,desc:f,imageUrl:o,userId:(t=(e=T)==null?void 0:e.currentUser)==null?void 0:t.uid}),i(),y(""),P(""),R(null),j.current&&(j.current.value=""),c(!1)}catch(N){console.error(N),c(!1)}}else console.error("Something is not selected (image or title or desc)")},B=async(e,t)=>{try{const s=g(l,"PackingCards",e);if(await _(s),t){const r=d(u,t);try{await b(r),console.log("Image deleted successfully")}catch(o){console.error("Error deleting image: ",o)}}i(),console.log("PackingCard and image deleted")}catch(s){console.error("Error deleting PackingCard or image: ",s)}},z=async e=>{try{const t=g(l,"PackingCards",e);await p(t,{title:v}),i(),U(""),console.log("PackingCard updated")}catch(t){console.error("while updating title",t)}},O=async(e,t)=>{if(C)try{const s=`${Date.now()}-${C.name}`,r=d(u,`images/${s}`);await A(r,C);const o=await $(r),N=g(l,"PackingCards",e);if(t){const J=d(u,t);await b(J)}await p(N,{imageUrl:o}),i(),E(null),w.current&&(w.current.value=""),console.log("Image updated")}catch(s){console.error("Error updating image: ",s)}else console.error("No image selected for update")},G=async(e,t)=>{const s=d(u,t);try{await b(s);const r=g(l,"PackingCards",e);await p(r,{imageUrl:""}),i(),console.log("Image deleted")}catch(r){console.error("Error deleting image: ",r)}},H=async e=>{try{const t=g(l,"PackingCards",e);await p(t,{desc:D}),i(),I(""),console.log("PackingCard date updated")}catch(t){console.error("while updating release date",t)}};return a.jsxs("div",{className:"PackingCard-admin-wrapper",children:[m&&a.jsx(K,{}),a.jsxs("div",{className:"right-side-wrapper",children:[a.jsx(M,{}),m&&a.jsxs("div",{className:"controlAuthWrapper",children:[a.jsx("h2",{className:"addPackingCardTitle",children:"Add New Packing Card"}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Packing Card title...",value:h,onChange:e=>y(e.target.value)}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Packing Card desc...",value:f,onChange:e=>P(e.target.value)}),a.jsx("input",{className:"admin-input",type:"file",ref:j,onChange:e=>R(e.target.files?e.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:q,disabled:k,children:"Submit Packing Card"})]}),m&&(k?a.jsx("div",{className:"loading-indicator",children:a.jsx(X,{size:50,color:"#eee",loading:k})}):a.jsx("div",{className:"controlDataWrapper",children:F.map(e=>a.jsx("div",{className:"PackingCardItemWrapperFire",children:m&&a.jsxs(a.Fragment,{children:[a.jsx("h1",{style:{color:"white"},children:e.title}),a.jsx("p",{children:e.desc}),e.imageUrl&&a.jsx("img",{className:"PackingCardImgFire",src:e.imageUrl,alt:e.title,width:"500"}),a.jsx("button",{className:"admin-btn",onClick:()=>B(e.id,e.imageUrl),children:"Delete Packing Card"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",onChange:t=>U(t.target.value),type:"text",value:v,placeholder:"new title..."}),a.jsx("button",{className:"admin-btn",onClick:()=>z(e.id),children:"Update Title"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"file",ref:w,onChange:t=>E(t.target.files?t.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:()=>O(e.id,e.imageUrl),children:"Update Image"}),a.jsx("br",{}),a.jsx("button",{className:"admin-btn",onClick:()=>G(e.id,e.imageUrl),children:"Delete Image"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"text",onChange:t=>I(t.target.value),value:D,placeholder:"new desc..."}),a.jsx("button",{className:"admin-btn",onClick:()=>H(e.id),children:"Update Desc"})]})},e.id))}))]})]})};export{se as default};
