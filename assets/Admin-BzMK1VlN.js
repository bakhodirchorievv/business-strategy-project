import{r as n,j as a}from"./index-Ba2WZYOS.js";import{N as M,A as P}from"./NavBar-MN7_mVqQ.js";import{c as Q,d as c,o as V,a as k,C as X,g as Y,r as d,s as u,u as $,b as F,e as Z,f as m,h as _,i as y,j as p}from"./ClipLoader-Dn82_zr4.js";const ee=()=>{const[W,q]=n.useState([]),[h,D]=n.useState(""),[f,I]=n.useState(""),[v,U]=n.useState(""),[S,R]=n.useState(""),[g,E]=n.useState(null),[x,A]=n.useState(null),[j,L]=n.useState(null),w=n.useRef(null),C=n.useRef(null),T=Q(c,"cases"),[N,o]=n.useState(!0),r=async()=>{o(!0);try{const t=(await Y(T)).docs.map(s=>({...s.data(),id:s.id}));q(t),o(!1)}catch(e){console.error(e),o(!1)}};n.useEffect(()=>{r();const e=V(k,t=>{E(t?t.email:null)});return()=>e()},[]);const B=async()=>{var e,t;if(x&&f&&h){o(!0);const s=`${Date.now()}-${x.name}`,l=d(u,`images/${s}`);await $(l,x);const i=await F(l);try{await Z(T,{title:h,desc:f,imageUrl:i,userId:(t=(e=k)==null?void 0:e.currentUser)==null?void 0:t.uid}),r(),D(""),I(""),A(null),w.current&&(w.current.value=""),o(!1)}catch(b){console.error(b),o(!1)}}else console.error("Something is not selected (image or title or desc)")},z=async(e,t)=>{try{const s=m(c,"cases",e);if(await _(s),t){const l=d(u,t);try{await y(l),console.log("Image deleted successfully")}catch(i){console.error("Error deleting image: ",i)}}r(),console.log("Case and image deleted")}catch(s){console.error("Error deleting Case or image: ",s)}},O=async e=>{try{const t=m(c,"cases",e);await p(t,{title:S}),r(),R(""),console.log("Case updated")}catch(t){console.error("while updating title",t)}},G=async(e,t)=>{if(j)try{const s=`${Date.now()}-${j.name}`,l=d(u,`images/${s}`);await $(l,j);const i=await F(l),b=m(c,"cases",e);if(t){const K=d(u,t);await y(K)}await p(b,{imageUrl:i}),r(),L(null),C.current&&(C.current.value=""),console.log("Image updated")}catch(s){console.error("Error updating image: ",s)}else console.error("No image selected for update")},H=async(e,t)=>{const s=d(u,t);try{await y(s);const l=m(c,"cases",e);await p(l,{imageUrl:""}),r(),console.log("Image deleted")}catch(l){console.error("Error deleting image: ",l)}},J=async e=>{try{const t=m(c,"cases",e);await p(t,{desc:v}),r(),U(""),console.log("Case date updated")}catch(t){console.error("while updating release date",t)}};return a.jsxs("div",{className:"adminWrapper",children:[g&&a.jsx(M,{}),a.jsxs("div",{className:"right-side-wrapper",children:[a.jsx(P,{}),g&&a.jsxs("div",{className:"controlAuthWrapper",children:[a.jsx("h2",{className:"addCaseTitle",children:"Add New Case"}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Case title...",value:h,onChange:e=>D(e.target.value)}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Case desc...",value:f,onChange:e=>I(e.target.value)}),a.jsx("input",{className:"admin-input",type:"file",ref:w,onChange:e=>A(e.target.files?e.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:B,disabled:N,children:"Submit Case"})]}),g&&(N?a.jsx("div",{className:"loading-indicator",children:a.jsx(X,{size:50,color:"#eee",loading:N})}):a.jsx("div",{className:"controlDataWrapper",children:W.map(e=>a.jsx("div",{className:"caseItemWrapperFire",children:g&&a.jsxs(a.Fragment,{children:[a.jsx("h1",{style:{color:"white"},children:e.title}),a.jsx("p",{children:e.desc}),e.imageUrl&&a.jsx("img",{className:"caseImgFire",src:e.imageUrl,alt:e.title,width:"500"}),a.jsx("button",{className:"admin-btn",onClick:()=>z(e.id,e.imageUrl),children:"Delete Case"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",onChange:t=>R(t.target.value),type:"text",value:S,placeholder:"new title..."}),a.jsx("button",{className:"admin-btn",onClick:()=>O(e.id),children:"Update Title"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"file",ref:C,onChange:t=>L(t.target.files?t.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:()=>G(e.id,e.imageUrl),children:"Update Image"}),a.jsx("br",{}),a.jsx("button",{className:"admin-btn",onClick:()=>H(e.id,e.imageUrl),children:"Delete Image"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"text",onChange:t=>U(t.target.value),value:v,placeholder:"new desc..."}),a.jsx("button",{className:"admin-btn",onClick:()=>J(e.id),children:"Update Desc"})]})},e.id))}))]})]})},ne=()=>a.jsx("div",{children:a.jsx(ee,{})});export{ne as default};
