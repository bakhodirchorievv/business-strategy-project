import{r,j as t}from"./index-Dc_audPd.js";import{N as M,A as P}from"./NavBar-BRHtXy5k.js";import{c as Q,o as V,C as X,d as i,g as Y,a as A,r as d,u as $,b as F,e as Z,f as u,h as _,s as m,i as b,j as g}from"./ClipLoader-DufgO8qg.js";const se=()=>{const[W,q]=r.useState([]),[x,y]=r.useState(""),[h,D]=r.useState(""),[I,v]=r.useState(""),[U,S]=r.useState(""),[p,R]=r.useState(null),[f,L]=r.useState(null),[C,T]=r.useState(null),j=r.useRef(null),w=r.useRef(null),k=Q(i,"ExpertCards"),[E,o]=r.useState(!0),l=async()=>{o(!0);try{const a=(await Y(k)).docs.map(s=>({...s.data(),id:s.id}));q(a),o(!1)}catch(e){console.error(e),o(!1)}};r.useEffect(()=>{l();const e=V(A,a=>{R(a?a.email:null)});return()=>e()},[]);const B=async()=>{var e,a;if(f&&h&&x){o(!0);const s=`${Date.now()}-${f.name}`,n=d(m,`images/${s}`);await $(n,f);const c=await F(n);try{await Z(k,{title:x,desc:h,imageUrl:c,userId:(a=(e=A)==null?void 0:e.currentUser)==null?void 0:a.uid}),l(),y(""),D(""),L(null),j.current&&(j.current.value=""),o(!1)}catch(N){console.error(N),o(!1)}}else console.error("Something is not selected (image or title or desc)")},z=async(e,a)=>{try{const s=u(i,"ExpertCards",e);if(await _(s),a){const n=d(m,a);try{await b(n),console.log("Image deleted successfully")}catch(c){console.error("Error deleting image: ",c)}}l(),console.log("ExpertCard and image deleted")}catch(s){console.error("Error deleting ExpertCard or image: ",s)}},O=async e=>{try{const a=u(i,"ExpertCards",e);await g(a,{title:U}),l(),S(""),console.log("ExpertCard updated")}catch(a){console.error("while updating title",a)}},G=async(e,a)=>{if(C)try{const s=`${Date.now()}-${C.name}`,n=d(m,`images/${s}`);await $(n,C);const c=await F(n),N=u(i,"ExpertCards",e);if(a){const K=d(m,a);await b(K)}await g(N,{imageUrl:c}),l(),T(null),w.current&&(w.current.value=""),console.log("Image updated")}catch(s){console.error("Error updating image: ",s)}else console.error("No image selected for update")},H=async(e,a)=>{const s=d(m,a);try{await b(s);const n=u(i,"ExpertCards",e);await g(n,{imageUrl:""}),l(),console.log("Image deleted")}catch(n){console.error("Error deleting image: ",n)}},J=async e=>{try{const a=u(i,"ExpertCards",e);await g(a,{desc:I}),l(),v(""),console.log("ExpertCard date updated")}catch(a){console.error("while updating release date",a)}};return t.jsxs("div",{className:"ExpertCard-admin-wrapper",children:[p&&t.jsx(M,{}),t.jsxs("div",{className:"right-side-wrapper",children:[t.jsx(P,{}),p&&t.jsxs("div",{className:"controlAuthWrapper",children:[t.jsx("h2",{className:"addExpertCardTitle",children:"Add New Expert Card"}),t.jsx("input",{className:"admin-input",type:"text",placeholder:"Expert Card title...",value:x,onChange:e=>y(e.target.value)}),t.jsx("input",{className:"admin-input",type:"text",placeholder:"Expert Card desc...",value:h,onChange:e=>D(e.target.value)}),t.jsx("input",{className:"admin-input",type:"file",ref:j,onChange:e=>L(e.target.files?e.target.files[0]:null)}),t.jsx("button",{className:"admin-btn",onClick:B,disabled:E,children:"Submit Expert Card"})]}),p&&(E?t.jsx("div",{className:"loading-indicator",children:t.jsx(X,{size:50,color:"#eee",loading:E})}):t.jsx("div",{className:"controlDataWrapper",children:W.map(e=>t.jsx("div",{className:"ExpertCardItemWrapperFire",children:p&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{style:{color:"white"},children:e.title}),t.jsx("p",{children:e.desc}),e.imageUrl&&t.jsx("img",{className:"ExpertCardImgFire",src:e.imageUrl,alt:e.title,width:"500"}),t.jsx("button",{className:"admin-btn",onClick:()=>z(e.id,e.imageUrl),children:"Delete Expert Card"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",onChange:a=>S(a.target.value),type:"text",value:U,placeholder:"new title..."}),t.jsx("button",{className:"admin-btn",onClick:()=>O(e.id),children:"Update Title"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",type:"file",ref:w,onChange:a=>T(a.target.files?a.target.files[0]:null)}),t.jsx("button",{className:"admin-btn",onClick:()=>G(e.id,e.imageUrl),children:"Update Image"}),t.jsx("br",{}),t.jsx("button",{className:"admin-btn",onClick:()=>H(e.id,e.imageUrl),children:"Delete Image"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",type:"text",onChange:a=>v(a.target.value),value:I,placeholder:"new desc..."}),t.jsx("button",{className:"admin-btn",onClick:()=>J(e.id),children:"Update Desc"})]})},e.id))}))]})]})};export{se as default};
