import{r as s,j as a}from"./index-DbbijAn3.js";import{N as M,A as P}from"./NavBar-DIBlbbNB.js";import{c as Q,o as V,C as X,d as i,g as Y,a as A,r as d,u as $,b as F,e as Z,f as u,h as _,s as m,i as y,j as g}from"./ClipLoader-C4nJoNf4.js";const re=()=>{const[W,q]=s.useState([]),[C,D]=s.useState(""),[h,I]=s.useState(""),[v,U]=s.useState(""),[S,R]=s.useState(""),[p,E]=s.useState(null),[f,L]=s.useState(null),[x,T]=s.useState(null),j=s.useRef(null),w=s.useRef(null),k=Q(i,"CorporateCards"),[N,l]=s.useState(!0),n=async()=>{l(!0);try{const t=(await Y(k)).docs.map(r=>({...r.data(),id:r.id}));q(t),l(!1)}catch(e){console.error(e),l(!1)}};s.useEffect(()=>{n();const e=V(A,t=>{E(t?t.email:null)});return()=>e()},[]);const B=async()=>{var e,t;if(l(!0),f&&h&&C){const r=`${Date.now()}-${f.name}`,o=d(m,`images/${r}`);await $(o,f);const c=await F(o);try{await Z(k,{title:C,desc:h,imageUrl:c,userId:(t=(e=A)==null?void 0:e.currentUser)==null?void 0:t.uid}),n(),D(""),I(""),L(null),j.current&&(j.current.value=""),l(!1)}catch(b){console.error(b),l(!1)}}else console.error("Something is not selected (image or title or desc)")},z=async(e,t)=>{try{const r=u(i,"CorporateCards",e);if(await _(r),t){const o=d(m,t);try{await y(o),console.log("Image deleted successfully")}catch(c){console.error("Error deleting image: ",c)}}n(),console.log("CorporateCard and image deleted")}catch(r){console.error("Error deleting CorporateCard or image: ",r)}},O=async e=>{try{const t=u(i,"CorporateCards",e);await g(t,{title:S}),n(),R(""),console.log("CorporateCard updated")}catch(t){console.error("while updating title",t)}},G=async(e,t)=>{if(x)try{const r=`${Date.now()}-${x.name}`,o=d(m,`images/${r}`);await $(o,x);const c=await F(o),b=u(i,"CorporateCards",e);if(t){const K=d(m,t);await y(K)}await g(b,{imageUrl:c}),n(),T(null),w.current&&(w.current.value=""),console.log("Image updated")}catch(r){console.error("Error updating image: ",r)}else console.error("No image selected for update")},H=async(e,t)=>{const r=d(m,t);try{await y(r);const o=u(i,"CorporateCards",e);await g(o,{imageUrl:""}),n(),console.log("Image deleted")}catch(o){console.error("Error deleting image: ",o)}},J=async e=>{try{const t=u(i,"CorporateCards",e);await g(t,{desc:v}),n(),U(""),console.log("CorporateCard date updated")}catch(t){console.error("while updating release date",t)}};return a.jsxs("div",{className:"CorporateCard-admin-wrapper",children:[p&&a.jsx(M,{}),a.jsxs("div",{className:"right-side-wrapper",children:[a.jsx(P,{}),p&&a.jsxs("div",{className:"controlAuthWrapper",children:[a.jsx("h2",{className:"addCorporateCardTitle",children:"Add New Corporate Card"}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Corporate Card title...",value:C,onChange:e=>D(e.target.value)}),a.jsx("input",{className:"admin-input",type:"text",placeholder:"Corporate Card desc...",value:h,onChange:e=>I(e.target.value)}),a.jsx("input",{className:"admin-input",type:"file",ref:j,onChange:e=>L(e.target.files?e.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:B,disabled:N,children:"Submit Corporate Card"})]}),p&&(N?a.jsx("div",{className:"loading-indicator",children:a.jsx(X,{size:50,color:"#eee",loading:N})}):a.jsx("div",{className:"controlDataWrapper",children:W.map(e=>a.jsx("div",{className:"CorporateCardItemWrapperFire",children:p&&a.jsxs(a.Fragment,{children:[a.jsx("h1",{style:{color:"white"},children:e.title}),a.jsx("p",{children:e.desc}),e.imageUrl&&a.jsx("img",{className:"CorporateCardImgFire",src:e.imageUrl,alt:e.title,width:"500"}),a.jsx("button",{className:"admin-btn",onClick:()=>z(e.id,e.imageUrl),children:"Delete Corporate Card"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",onChange:t=>R(t.target.value),type:"text",value:S,placeholder:"new title..."}),a.jsx("button",{className:"admin-btn",onClick:()=>O(e.id),children:"Update Title"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"file",ref:w,onChange:t=>T(t.target.files?t.target.files[0]:null)}),a.jsx("button",{className:"admin-btn",onClick:()=>G(e.id,e.imageUrl),children:"Update Image"}),a.jsx("br",{}),a.jsx("button",{className:"admin-btn",onClick:()=>H(e.id,e.imageUrl),children:"Delete Image"}),a.jsx("br",{}),a.jsx("input",{className:"admin-input",type:"text",onChange:t=>U(t.target.value),value:v,placeholder:"new desc..."}),a.jsx("button",{className:"admin-btn",onClick:()=>J(e.id),children:"Update Desc"})]})},e.id))}))]})]})};export{re as default};
