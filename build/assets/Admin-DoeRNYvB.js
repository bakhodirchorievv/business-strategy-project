import{r as a,j as t}from"./index-CAt4J3os.js";import{o as F,a as u,b as z,s as H,e as J,f as K,c as Q,d,g as V,r as x,h as j,u as A,i as L,j as X,k as w,l as Y,m as k,n as N}from"./FirebaseConfig-BfNWVVN1.js";const Z=()=>{const[S,v]=a.useState(""),[g,y]=a.useState(""),[c,r]=a.useState(null),[b,m]=a.useState(!1),C=async()=>{try{await z(u,S,g),r("Successfully logged in!")}catch(n){console.error(n),r("Error logging in")}},I=async()=>{try{await H(u,J),r("Successfully logged in!")}catch(n){console.error(n),r("Error logging in!")}},p=async()=>{try{await K(u),r("Successfully logged out!")}catch(n){console.error(n),r("Error logging out!")}};return a.useEffect(()=>{const n=F(u,h=>{m(!!h)});return()=>n()},[]),a.useEffect(()=>{if(c){const n=setTimeout(()=>{r(null)},3e3);return()=>clearTimeout(n)}},[c]),t.jsx(t.Fragment,{children:b?t.jsx("button",{className:"logOutFire admin-btn",onClick:p,children:"Log Out"}):t.jsxs("div",{style:{backgroundColor:"#333"},children:[c&&t.jsx("div",{className:"message",children:c}),t.jsx("input",{placeholder:"Email...",onChange:n=>v(n.target.value)}),t.jsx("input",{placeholder:"Password...",type:"password",onChange:n=>y(n.target.value)}),t.jsx("br",{}),t.jsx("button",{onClick:C,children:"Sign In"}),t.jsx("button",{onClick:I,children:"Sign In With Google"})]})})},te=()=>{const[S,v]=a.useState([]),[g,y]=a.useState(""),[c,r]=a.useState(""),[b,m]=a.useState(""),[C,I]=a.useState(""),[p,n]=a.useState(null),[h,R]=a.useState(null),[D,T]=a.useState(null),E=a.useRef(null),U=a.useRef(null),W=Q(d,"cases"),i=async()=>{try{const s=(await V(W)).docs.map(o=>({...o.data(),id:o.id}));v(s)}catch(e){console.error(e)}};a.useEffect(()=>{i();const e=F(u,s=>{n(s?s.email:null)});return()=>e()},[]);const O=async()=>{var e,s;if(h&&c&&g){const o=x(j,`images/${h.name}`);await A(o,h);const l=await L(o);try{await X(W,{title:g,desc:c,imageUrl:l,userId:(s=(e=u)==null?void 0:e.currentUser)==null?void 0:s.uid}),i(),y(""),r(""),R(null),E.current&&(E.current.value="")}catch(f){console.error(f)}}else console.error("Something is not selected (image or title or desc)")},P=async(e,s)=>{try{const o=w(d,"cases",e);if(await Y(o),s){const l=x(j,s);try{await k(l),console.log("Image deleted successfully")}catch(f){console.error("Error deleting image: ",f)}}i(),console.log("Case and image deleted")}catch(o){console.error("Error deleting Case or image: ",o)}},G=async e=>{try{const s=w(d,"cases",e);await N(s,{title:C}),i(),I(""),console.log("Case updated")}catch(s){console.error("while updating title",s)}},$=async(e,s)=>{if(D)try{const o=x(j,`images/${D.name}`);await A(o,D);const l=await L(o),f=w(d,"cases",e);if(s){const q=x(j,s);await k(q)}await N(f,{imageUrl:l}),i(),T(null),U.current&&(U.current.value=""),console.log("Image updated")}catch(o){console.error("Error updating image: ",o)}else console.error("No image selected for update")},B=async(e,s)=>{const o=x(j,s);try{await k(o);const l=w(d,"cases",e);await N(l,{imageUrl:""}),i(),console.log("Image deleted")}catch(l){console.error("Error deleting image: ",l)}},M=async e=>{try{const s=w(d,"cases",e);await N(s,{desc:b}),i(),m(""),console.log("Case date updated")}catch(s){console.error("while updating release date",s)}};return t.jsxs("div",{className:"adminWrapper",children:[t.jsx(Z,{}),p&&t.jsxs("div",{className:"controlAuthWrapper",children:[t.jsx("h2",{className:"addCaseTitle",children:"Add New Case"}),t.jsx("input",{className:"admin-input",type:"text",placeholder:"Case title...",value:g,onChange:e=>y(e.target.value)}),t.jsx("input",{className:"admin-input",type:"text",placeholder:"Case desc...",value:c,onChange:e=>r(e.target.value)}),t.jsx("input",{className:"admin-input",type:"file",ref:E,onChange:e=>R(e.target.files?e.target.files[0]:null)}),t.jsx("button",{className:"admin-btn",onClick:O,children:"Submit Case"})]}),p&&t.jsx("div",{className:"controlDataWrapper",children:S.map(e=>t.jsx("div",{className:"caseItemWrapperFire",children:p&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{style:{color:"white"},children:e.title}),t.jsx("p",{children:e.desc}),e.imageUrl&&t.jsx("img",{className:"caseImgFire",src:e.imageUrl,alt:e.title,width:"500"}),t.jsx("button",{className:"admin-btn",onClick:()=>P(e.id,e.imageUrl),children:"Delete Case"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",onChange:s=>I(s.target.value),type:"text",value:C,placeholder:"new title..."}),t.jsx("button",{className:"admin-btn",onClick:()=>G(e.id),children:"Update Title"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",type:"file",ref:U,onChange:s=>T(s.target.files?s.target.files[0]:null)}),t.jsx("button",{className:"admin-btn",onClick:()=>$(e.id,e.imageUrl),children:"Update Image"}),t.jsx("br",{}),t.jsx("button",{className:"admin-btn",onClick:()=>B(e.id,e.imageUrl),children:"Delete Image"}),t.jsx("br",{}),t.jsx("input",{className:"admin-input",type:"text",onChange:s=>m(s.target.value),value:b,placeholder:"new desc..."}),t.jsx("button",{className:"admin-btn",onClick:()=>M(e.id),children:"Update Desc"})]})},e.id))})]})};export{te as default};
